{"version":3,"sources":["uni-app:///main.js",null,"webpack:///E:/WeChat/uni-app/smart-health-uniapp/pages/my/second/userInfo.vue?b06a","webpack:///E:/WeChat/uni-app/smart-health-uniapp/pages/my/second/userInfo.vue?1ebf","webpack:///E:/WeChat/uni-app/smart-health-uniapp/pages/my/second/userInfo.vue?6c35","uni-app:///pages/my/second/userInfo.vue","webpack:///E:/WeChat/uni-app/smart-health-uniapp/pages/my/second/userInfo.vue?3c54","webpack:///E:/WeChat/uni-app/smart-health-uniapp/pages/my/second/userInfo.vue?dacc"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","safeAreaInsets","isEditMode","userInfo","gender","age","city","healthStatus","avatar","genderOptions","selectedFile","imageStyles","width","height","border","color","style","radius","methods","chooseImage","uni","count","sizeType","sourceType","success","fail","console","title","icon","handleBack","content","url","toggleEditMode","cancelEdit","handleFileSelect","handleFileDelete","saveChanges","userId","username","uploadAvatar","mask","resData","userData","submitUserInfo","handleError","handleGenderChange","handleCityChange","incrementAge","decrementAge","getUserInfo","onLoad"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,iBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;AACc;;;AAGrE;AACiL;AACjL,gBAAgB,0LAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,aAAa,0SAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAA8pB,CAAgB,mrBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;AC6HlrB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;IACA;MACA;MACAC;MACA;MACAC;MACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MACAC;MACA;MACAD;MACA;MACAE;MACA;MACAC;QACAC;QACAC;QACAC;UACAC;UACAH;UACAI;UACAC;QACA;MACA;IACA;EACA;EAEAC;IACA;IACAC;MAAA;MACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;UACA;UACA;UACA;QACA;QACAC;UACAC;UACAN;YACAO;YACAC;UACA;QACA;MACA;IACA;IACA;IACAC;MAAA;MACA;QACAT;UACAO;UACAG;UACAN;YACA;cACA;cACAJ;gBACAW;cACA;YACA;UACA;QACA;MACA;QACAX;UACAW;QACA;MACA;IACA;IAEA;IACAC;MACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACA;MACA;MACA;MACA;;MAEA;MACA;QACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEA;IACAC;MACA;MACA;QACAhB;UACAO;UACAC;QACA;QACA;MACA;;MAEA;MACAR;QACAO;MACA;;MAEA;MACA;QACAU;QACAC;QACAlC;QACAC;QACAC;QACAE;MACA;;MAEA;MACA;QACA;MACA;QACA;QACA;MACA;IACA;IAEA;IACA+B;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAnB;kBACAO;kBACAa;gBACA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBAEA;gBACA;gBACArB;kBACAO;kBACAC;gBACA;gBACAc;gBACAhB;gBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAA;gBACA;gBACAN;kBACAO;kBACAC;gBACA;cAAA;gBAAA;gBAEAR;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAuB;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBACAvB;kBACAO;kBACAC;gBACA;;gBAEA;gBACA;kBACA;gBACA;;gBAEA;gBACA;gBACA;gBACA;;gBAEA;gBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAgB;MACAxB;MACAA;QACAO;QACAC;MACA;IACA;IAEA;IACAiB;MACAnB;MACA;MACA;IACA;IAEA;IACAoB;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QAAA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QAAA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBAAA;gBAAAjD;gBACA;gBACA;kBACA;gBACA;gBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EACA;EACAkD;IACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrYA;AAAA;AAAA;AAAA;AAAyvC,CAAgB,stCAAG,EAAC,C;;;;;;;;;;;ACA7wC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/my/second/userInfo.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/my/second/userInfo.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./userInfo.vue?vue&type=template&id=77ad5faa&\"\nvar renderjs\nimport script from \"./userInfo.vue?vue&type=script&lang=js&\"\nexport * from \"./userInfo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./userInfo.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/my/second/userInfo.vue\"\nexport default component.exports","export * from \"-!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./userInfo.vue?vue&type=template&id=77ad5faa&\"","var components\ntry {\n  components = {\n    uniNavBar: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-ui/lib/uni-nav-bar/uni-nav-bar\" */ \"@dcloudio/uni-ui/lib/uni-nav-bar/uni-nav-bar.vue\"\n      )\n    },\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons\" */ \"@dcloudio/uni-ui/lib/uni-icons/uni-icons.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./userInfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./userInfo.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"container\">\r\n    <!-- 顶部导航栏 -->\r\n    <view class=\"box-bg\">\r\n      <uni-nav-bar shadow backgroundColor=\"#44cf9a\" left-icon=\"left\" @clickLeft=\"handleBack\" :status-bar=\"true\">\r\n        <view class=\"title-custom\">个人信息</view>\r\n        <template v-slot:right>\r\n          <view v-if=\"isEditMode\" class=\"save-nav-btn\" @click=\"saveChanges\">保存</view>\r\n        </template>\r\n      </uni-nav-bar>\r\n    </view>\r\n\r\n    <!-- 主内容区 -->\r\n    <view class=\"content\">\r\n      <!-- 个人信息卡片 -->\r\n      <view class=\"info-card\">\r\n        <!-- 头像区域 -->\r\n        <view class=\"avatar-section\">\r\n          <!-- 非编辑模式：显示头像 -->\r\n          <view v-if=\"!isEditMode\" class=\"avatar-wrapper\">\r\n            <image class=\"avatar\" :src=\"userInfo.avatar || '../../../static/image/avatar.png'\"\r\n                   mode=\"aspectFill\"></image>\r\n          </view>\r\n\r\n          <!-- 编辑模式：显示上传组件 -->\r\n          <view v-else class=\"avatar-upload-container\" @click=\"chooseImage\">\r\n            <image v-if=\"avatar\" :src=\"avatar\" mode=\"aspectFill\" :class=\"imageStyles\"></image>\r\n            <uni-icons v-else type=\"plusempty\" size=\"50\" color=\"#999\"></uni-icons>\r\n          </view>\r\n\r\n          <text class=\"username\">{{ userInfo.username }}</text>\r\n          <text class=\"user-id\">ID: {{ userInfo.userId }}</text>\r\n        </view>\r\n\r\n        <!-- 信息列表 -->\r\n        <view class=\"info-list\">\r\n          <!-- 姓名 -->\r\n          <view class=\"info-item\">\r\n            <view class=\"info-label\">\r\n              <uni-icons type=\"person\" size=\"30\"></uni-icons>\r\n              <text>姓名</text>\r\n            </view>\r\n            <view class=\"info-value\">\r\n              <text v-if=\"!isEditMode\" class=\"display-value\">{{ userInfo.username }}</text>\r\n              <input v-else type=\"text\" v-model=\"userInfo.username\" placeholder=\"请输入姓名\" />\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 性别 -->\r\n          <view class=\"info-item\">\r\n            <view class=\"info-label\">\r\n              <uni-icons type=\"staff\" size=\"30\"></uni-icons>\r\n              <text>性别</text>\r\n            </view>\r\n            <view class=\"info-value\">\r\n              <text v-if=\"!isEditMode\" class=\"display-value\">{{ userInfo.gender === 1 ? \"男\": \"女\" }}</text>\r\n              <picker v-else mode=\"selector\" :range=\"genderOptions\" @change=\"handleGenderChange\">\r\n                <view class=\"picker-value\">{{ userInfo.gender === 1 ? \"男\": \"女\" }}</view>\r\n              </picker>\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 年龄 -->\r\n          <view class=\"info-item\">\r\n            <view class=\"info-label\">\r\n              <uni-icons type=\"contact\" size=\"30\"></uni-icons>\r\n              <text>年龄</text>\r\n            </view>\r\n            <view class=\"info-value\">\r\n              <text v-if=\"!isEditMode\" class=\"display-value\">{{ userInfo.age }}</text>\r\n              <view v-else class=\"number-stepper\">\r\n                <view class=\"stepper-btn minus\" @click=\"decrementAge\">\r\n                  <uni-icons type=\"minus\" size=\"20\" color=\"#64748b\"></uni-icons>\r\n                </view>\r\n                <text class=\"stepper-value\">{{ userInfo.age }}</text>\r\n                <view class=\"stepper-btn plus\" @click=\"incrementAge\">\r\n                  <uni-icons type=\"plus\" size=\"20\" color=\"#64748b\"></uni-icons>\r\n                </view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 城市 -->\r\n          <view class=\"info-item\">\r\n            <view class=\"info-label\">\r\n              <uni-icons type=\"location\" size=\"30\"></uni-icons>\r\n              <text>城市</text>\r\n            </view>\r\n            <view class=\"info-value\">\r\n              <text v-if=\"!isEditMode\" class=\"display-value\">{{ userInfo.city }}</text>\r\n              <picker v-else mode=\"region\" @change=\"handleCityChange\">\r\n                <view class=\"picker-value\">{{ userInfo.city }}</view>\r\n              </picker>\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 身体健康状态 - 不可编辑 -->\r\n          <view class=\"info-item\">\r\n            <view class=\"info-label\">\r\n              <van-icon name=\"like-o\" size=\"26px\" />\r\n              <text>健康状态</text>\r\n            </view>\r\n            <view class=\"info-value\">\r\n              <text class=\"display-value\">{{ userInfo.healthStatus === 1 ? \"健康\" :\"生病\" }}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 编辑按钮 -->\r\n      <button class=\"edit-btn\" :class=\"{ 'cancel-btn': isEditMode }\" @click=\"toggleEditMode\">\r\n        <uni-icons v-if=\"!isEditMode\" type=\"compose\" size=\"18\" color=\"#ffffff\"></uni-icons>\r\n        <text>{{ isEditMode ? '取消' : '编辑个人信息' }}</text>\r\n      </button>\r\n\r\n      <!-- 保存按钮 -->\r\n      <button v-if=\"isEditMode\" class=\"save-button\" @click=\"saveChanges\">\r\n        <uni-icons type=\"save\" size=\"18\" color=\"#ffffff\"></uni-icons>\r\n        <text>保存修改</text>\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { getUserInfoAPI, updateUserInfoAPI } from '@/api/user';\r\nimport { uploadAPI } from '@/api/system';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 获取系统安全区域信息\r\n      safeAreaInsets: uni.getSystemInfoSync().safeAreaInsets,\r\n      // 是否处于编辑模式\r\n      isEditMode: false,\r\n      // 用户信息\r\n      userInfo: {\r\n        gender: 1,\r\n        age: '20',\r\n        city: '未知',\r\n        healthStatus: '',\r\n        avatar: '../../../static/image/avatar.png'\r\n      },\r\n      // 性别选项\r\n      genderOptions: ['女', '男', '保密'],\r\n      // 编辑前的备份数据\r\n      avatar: null,\r\n      // 选择的头像文件\r\n      selectedFile: null,\r\n      // 文件选择器样式配置\r\n      imageStyles: {\r\n        width: 120,\r\n        height: 120,\r\n        border: {\r\n          color: '#44cf9a',\r\n          width: 2,\r\n          style: 'dashed',\r\n          radius: '5px'\r\n        }\r\n      }\r\n    };\r\n  },\r\n \r\n  methods: {\r\n\t  // 选择图片\r\n\t  chooseImage() {\r\n\t    uni.chooseImage({\r\n\t      count: 1, // 默认9\r\n\t      sizeType: ['compressed'], // 可以指定是原图还是压缩图，默认二者都有\r\n\t      sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有\r\n\t      success: (res) => {\r\n\t        // 获取图片临时路径\r\n\t        this.avatar = res.tempFilePaths[0];\r\n\t        this.uploadStatus = '';\r\n\t      },\r\n\t      fail: (err) => {\r\n\t        console.error('选择图片失败:', err);\r\n\t        uni.showToast({\r\n\t          title: '选择图片失败',\r\n\t          icon: 'none'\r\n\t        });\r\n\t      }\r\n\t    });\r\n\t  },\r\n    // 返回上一页\r\n    handleBack() {\r\n      if (this.isEditMode) {\r\n        uni.showModal({\r\n          title: '提示',\r\n          content: '确定要放弃编辑吗？',\r\n          success: (res) => {\r\n            if (res.confirm) {\r\n              this.cancelEdit();\r\n              uni.switchTab({\r\n                url: \"/pages/my/my\"\r\n              });\r\n            }\r\n          }\r\n        });\r\n      } else {\r\n        uni.switchTab({\r\n          url: \"/pages/my/my\"\r\n        });\r\n      }\r\n    },\r\n\r\n    // 切换编辑模式\r\n    toggleEditMode() {\r\n      if (this.isEditMode) {\r\n        // 取消编辑，恢复数据\r\n        this.cancelEdit();\r\n      } else {\r\n        // 进入编辑模式，先备份数据\r\n        this.backupUserInfo = JSON.parse(JSON.stringify(this.userInfo));\r\n        this.isEditMode = true;\r\n      }\r\n    },\r\n\r\n    // 取消编辑\r\n    cancelEdit() {\r\n      // 恢复备份的数据\r\n      if (this.backupUserInfo) {\r\n        this.userInfo = JSON.parse(JSON.stringify(this.backupUserInfo));\r\n      }\r\n      this.isEditMode = false;\r\n      this.selectedFile = null;\r\n\r\n      // 重置文件选择器\r\n      if (this.$refs.filePicker) {\r\n        this.$refs.filePicker.clearFiles();\r\n      }\r\n    },\r\n\r\n    // 处理文件选择事件\r\n    handleFileSelect(e) {\r\n      this.selectedFile = e.tempFiles[0];\r\n    },\r\n\r\n    // 处理文件删除事件\r\n    handleFileDelete() {\r\n      this.selectedFile = null;\r\n    },\r\n\r\n    // 保存更改到后端\r\n    saveChanges() {\r\n      // 数据验证\r\n      if (!this.userInfo.username.trim()) {\r\n        uni.showToast({\r\n          title: '姓名不能为空',\r\n          icon: 'none'\r\n        });\r\n        return;\r\n      }\r\n\r\n      // 显示加载\r\n      uni.showLoading({\r\n        title: '保存中...'\r\n      });\r\n\r\n      // 构建要发送的用户数据\r\n      let userData = {\r\n        userId: this.userInfo.userId,\r\n        username: this.userInfo.username,\r\n        gender: this.userInfo.gender,\r\n        age: this.userInfo.age,\r\n        city: this.userInfo.city,\r\n        avatar: this.userInfo.avatar\r\n      };\r\n\r\n      // 如果有选择新头像，先上传头像文件\r\n      if (this.avatar) {\r\n        this.uploadAvatar(this.avatar, userData);\r\n      } else {\r\n        // 没有新头像，直接保存用户信息\r\n        this.submitUserInfo(userData);\r\n      }\r\n    },\r\n\r\n    // 上传头像到服务器\r\n    async uploadAvatar(filePath, userData) {\r\n\t\ttry {\r\n\t\t  uni.showLoading({\r\n\t\t    title: '上传中',\r\n\t\t    mask: true\r\n\t\t  });\r\n\t\t  \r\n\t\t  // 调用上传API\r\n\t\t  const resData = await uploadAPI(this.avatar);\r\n\t\t  \r\n\t\t  // 上传成功处理\r\n\t\t  this.uploadStatus = '上传成功';\r\n\t\t  uni.showToast({\r\n\t\t    title: '上传成功',\r\n\t\t    icon: 'success'\r\n\t\t  });\r\n\t\t  userData.avatar = resData.data.value\r\n\t\t  console.log(\"头像信息：\",userData.avatar)\r\n\t\t  // 保存用户信息到服务器\r\n\t\t  this.submitUserInfo(userData);\r\n\t\t  \r\n\t\t} catch (error) {\r\n\t\t  console.error('上传失败:', error);\r\n\t\t  this.uploadStatus = '上传失败';\r\n\t\t  uni.showToast({\r\n\t\t    title: '上传失败',\r\n\t\t    icon: 'none'\r\n\t\t  });\r\n\t\t} finally {\r\n\t\t  uni.hideLoading();\r\n\t\t}\r\n    },\r\n\r\n    // 提交用户信息到后端\r\n    async submitUserInfo(userData) {\r\n\t   await updateUserInfoAPI(userData)\r\n\t   uni.showToast({\r\n\t     title: '个人信息保存成功',\r\n\t     icon: 'success'\r\n\t   });\r\n\t   \r\n\t   // 将新头像更新到用户信息中\r\n\t   if (this.selectedFile && userData.avatar) {\r\n\t     this.userInfo.avatar = userData.avatar;\r\n\t   }\r\n\t   \r\n\t   // 更新备份数据\r\n\t   this.backupUserInfo = JSON.parse(JSON.stringify(this.userInfo));\r\n\t   this.isEditMode = false;\r\n\t   this.selectedFile = null;\r\n\t   \r\n\t   // 重置文件选择器\r\n\t   if (this.$refs.filePicker) {\r\n\t     this.$refs.filePicker.clearFiles();\r\n\t   }\r\n    },\r\n\r\n    // 处理错误\r\n    handleError(message) {\r\n      uni.hideLoading();\r\n      uni.showToast({\r\n        title: message,\r\n        icon: 'none'\r\n      });\r\n    },\r\n\r\n    // 性别选择器变更\r\n    handleGenderChange(e) {\r\n\t\tconsole.log(\"性别是：\",e)\r\n      const index = e.detail.value;\r\n      this.userInfo.gender =index\r\n    },\r\n\r\n    // 城市选择器变更\r\n    handleCityChange(e) {\r\n      const cityArray = e.detail.value;\r\n      // 省市区，只取市级\r\n      this.userInfo.city = cityArray[1];\r\n    },\r\n\r\n    // 年龄增加\r\n    incrementAge() {\r\n      const currentAge = parseInt(this.userInfo.age);\r\n      if (currentAge < 120) { // 设置最大年龄限制\r\n        this.userInfo.age = (currentAge + 1).toString();\r\n      }\r\n    },\r\n\r\n    // 年龄减少\r\n    decrementAge() {\r\n      const currentAge = parseInt(this.userInfo.age);\r\n      if (currentAge > 1) { // 设置最小年龄限制\r\n        this.userInfo.age = (currentAge - 1).toString();\r\n      }\r\n    },\r\n\tasync getUserInfo() {\r\n\t\tconst {data} = await getUserInfoAPI()\r\n\t\tthis.userInfo=data\r\n\t\tif(this.userInfo.age === null){\r\n\t\t\tthis.userInfo.age = 20\r\n\t\t}\r\n\t\tif(this.userInfo.city === null){\r\n\t\t\tthis.userInfo.city = '请设置'\r\n\t\t}\r\n\t},\r\n  },\r\n  onLoad() {\r\n    // 页面加载时从服务器获取用户信息\r\n    this.getUserInfo()\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\npage {\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #f7f8fa;\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n/* 自定义导航条 */\r\n.box-bg {\r\n  background-color: #44cf9a;\r\n  position: relative;\r\n  width: 100%;\r\n}\r\n\r\n/* 自定义标题样式 */\r\n.title-custom {\r\n  color: #000;\r\n  /* 黑色字体 */\r\n  text-align: center;\r\n  /* 居中显示 */\r\n  font-size: 16px;\r\n  /* 字体大小 */\r\n  font-weight: 600;\r\n  flex: 1;\r\n  /* 占据剩余空间 */\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.save-nav-btn {\r\n  font-size: 14px;\r\n  color: #000;\r\n  padding: 6px 12px;\r\n  border-radius: 20px;\r\n  background-color: rgba(255, 255, 255, 0.3);\r\n}\r\n\r\n/* 主内容区 */\r\n.content {\r\n  flex: 1;\r\n  padding: 20px 16px;\r\n}\r\n\r\n/* 个人信息卡片 */\r\n.info-card {\r\n  background: white;\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\r\n  margin-bottom: 20px;\r\n}\r\n\r\n/* 头像区域 */\r\n.avatar-section {\r\n  padding: 24px 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n  background-color: #f0f9ff;\r\n}\r\n\r\n.avatar-wrapper {\r\n  width: 88px;\r\n  height: 88px;\r\n  border-radius: 50%;\r\n  overflow: hidden;\r\n  border: 3px solid white;\r\n  box-shadow: 0 4px 10px rgba(14, 165, 233, 0.15);\r\n  margin-bottom: 12px;\r\n  position: relative;\r\n}\r\n\r\n.avatar {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n/* 头像上传容器 - 极简版本 */\r\n.avatar-upload-container {\r\n  width: 120px;\r\n  height: 120px;\r\n  border: 1px solid #ddd; /* 浅灰色边框 */\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  overflow: hidden; /* 确保图片不溢出 */\r\n  background-color: #f5f5f5; /* 浅灰色背景 */\r\n  \r\n  /* 图片样式 - 等比例填充 */\r\n  image {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover; /* 关键属性：等比例填充容器 */\r\n  }\r\n  \r\n  /* 加号图标样式 */\r\n  .uni-icons {\r\n    color: #999; /* 灰色图标 */\r\n  }\r\n}\r\n\r\n.username {\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: #0f172a;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.user-id {\r\n  font-size: 13px;\r\n  color: #64748b;\r\n}\r\n\r\n/* 信息项 */\r\n.info-list {\r\n  padding: 8px 0;\r\n}\r\n\r\n.info-item {\r\n  padding: 16px 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  border-bottom: 1px solid #f1f5f9;\r\n}\r\n\r\n.info-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.info-label {\r\n  font-size: 16px;\r\n  color: #334155;\r\n  font-weight: 500;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.info-label .uni-icons,\r\n.info-label van-icon {\r\n  margin-right: 8px;\r\n}\r\n\r\n.info-value {\r\n  font-size: 16px;\r\n  color: #64748b;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.info-value input {\r\n  text-align: right;\r\n  height: 24px;\r\n  min-height: 24px;\r\n  line-height: 24px;\r\n  color: #64748b;\r\n}\r\n\r\n.picker-value {\r\n  color: #64748b;\r\n}\r\n\r\n/* 数字步进器 */\r\n.number-stepper {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.stepper-btn {\r\n  width: 28px;\r\n  height: 28px;\r\n  border-radius: 50%;\r\n  background-color: #f1f5f9;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n}\r\n\r\n.stepper-value {\r\n  margin: 0 12px;\r\n  font-size: 16px;\r\n  color: #64748b;\r\n  min-width: 30px;\r\n  text-align: center;\r\n}\r\n\r\n/* 编辑按钮 */\r\n.edit-btn {\r\n  background: #44cf9a;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 30px;\r\n  padding: 14px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  width: 100%;\r\n  margin-top: 20px;\r\n  box-shadow: 0 4px 12px rgba(68, 207, 154, 0.25);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.edit-btn .uni-icons {\r\n  margin-right: 8px;\r\n}\r\n\r\n.cancel-btn {\r\n  background: #ef4444;\r\n  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.25);\r\n}\r\n\r\n/* 保存按钮 */\r\n.save-button {\r\n  background: #10b981;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 30px;\r\n  padding: 14px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  width: 100%;\r\n  margin-top: 16px;\r\n  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.save-button .uni-icons {\r\n  margin-right: 8px;\r\n}\r\n\r\n/* 自定义uni-file-picker组件样式 */\r\n:deep(.uni-file-picker__container) {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n:deep(.uni-file-picker__list) {\r\n  margin-top: 0;\r\n  margin-bottom: 0;\r\n}\r\n</style>\r\n","import mod from \"-!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./userInfo.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\WeChat-dev\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./userInfo.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1744294917737\n      var cssReload = require(\"D:/WeChat-dev/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}